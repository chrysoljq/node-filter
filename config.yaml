# mihomo-node-filter 配置文件

# === 全局设置 ===
global_ua: "clash-verge/2.4.114514"

# === 节点来源 ===
sources:
  # 订阅链接（取消注释并替换为你的链接）
  # - type: subscription
  #   url: "https://your-subscription-url.com/sub"
  #   timeout: 30

  # 本地文件
  # - type: file
  #   path: "./local_proxies.yaml"

# === 筛选设置 ===
filter:
  # 是否启用连通性测试 + 出口 IP 检测（精确模式，需要 mihomo 二进制）
  # false = 快速模式，仅通过入口 IP 检测
  # true  = 精确模式，启动 mihomo 获取出口 IP 检测（更准确但更慢）
  enable_connectivity_test: false

  # 连通性测试配置（仅精确模式使用）
  connectivity:
    mihomo_bin: "mihomo"
    test_url: "https://www.gstatic.com/generate_204"
    timeout: 5
    # 并发数：每批同时测试的节点数量（每个节点分配一个独立 listener 端口）
    concurrency: 20

  # AbuseIPDB 配置（可选，增强 IP 质量检测准确度）
  # 免费额度 1000 次/天，注册获取 API Key: https://www.abuseipdb.com/account/api
  abuseipdb:
    api_key: ""
    # 风险评分阈值：>= 此分数判定为高风险（0-100）
    abuse_score_threshold: 25

  # 名称关键词黑名单（包含这些词的节点直接过滤）
  name_blacklist:
    - "过期"
    - "剩余"
    - "到期"
    - "官网"
    - "续费"
    - "流量"
    - "套餐"
    - "订阅"

  # 名称关键词白名单（强制保留，优先级高于一切检测）
  name_whitelist: []

# === 输出设置 ===
output:
  dir: "./output"
  config_file: "filtered_config.yaml"
  proxies_file: "filtered_proxies.yaml"
  report_file: "filter_report.md"
  mixed_port: 7890
  api_port: 9090

# === 远程推送 ===
remote_push:
  enable: false
  # Worker 基础地址，例如 "https://your-worker.workers.dev"
  # 程序会自动拼接 /api/yaml 和 /api/report
  url: ""
  # 如果 Worker 设置了 SUB_TOKEN，请在此填写
  token: ""

# === 日志 ===
logging:
  level: "INFO"
